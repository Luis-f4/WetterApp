@startuml
actor User

participant "UserController" as UC
participant "UserService" as US
participant "AuthenticationManager" as AM
participant "MyUserDetailsService" as MUDS
participant "UserRepo" as UR
participant "JWTService" as JS
participant "JwtFilter" as JF
participant "SecurityContextHolder" as SCH
participant "Ziel-Controller" as ZC

User -> UC: POST /login (Benutzeranfrage)
UC -> US: Überprüfe Benutzeranmeldedaten
US -> AM: Authentifiziere Benutzer
AM -> MUDS: Lade Benutzerdetails
MUDS -> UR: Suche Benutzer nach Username
UR --> MUDS: Benutzer gefunden
MUDS --> AM: Rückgabe Benutzer-Details
AM --> US: Authentifizierung erfolgreich
US -> JS: Erstelle JWT-Token
JS --> US: Rückgabe des JWT-Tokens
US --> UC: Rückgabe Token an Benutzer
UC --> User: JWT-Token als Antwort

User -> JF: Anfrage mit JWT-Token
JF -> JS: Validierung des Tokens
JS --> JF: Token ist gültig
JF -> MUDS: Lade Benutzerdetails
MUDS -> UR: Suche Benutzer nach Username
UR --> MUDS: Rückgabe Benutzer
JF -> SCH: Setze authentifizierten Benutzer
JF -> ZC: Anfrage weiterleiten
ZC --> User: Antwort an Benutzer
@enduml
